<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®¡ç†å‘˜åå°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .header {
            background: rgba(255, 255, 255, 0.95);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header h1 {
            color: #667eea;
            font-size: 24px;
        }
        .header-buttons {
            display: flex;
            gap: 10px;
        }
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s;
        }
        .btn-primary {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }
        .btn-danger {
            background: linear-gradient(45deg, #ff6b6b, #ee5a5a);
            color: white;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        .main-container {
            flex: 1;
            display: flex;
            padding: 20px;
            gap: 20px;
            max-width: 1600px;
            margin: 0 auto;
            width: 100%;
        }
        .sidebar {
            width: 250px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        .sidebar-menu {
            list-style: none;
        }
        .sidebar-menu li {
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            margin-bottom: 8px;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .sidebar-menu li:hover {
            background: #f0f0f0;
        }
        .sidebar-menu li.active {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }
        .content {
            flex: 1;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            overflow-y: auto;
            max-height: calc(100vh - 100px);
        }
        .section {
            display: none;
        }
        .section.active {
            display: block;
        }
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e0e0e0;
        }
        .section-header h2 {
            color: #667eea;
            font-size: 24px;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-card {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
        }
        .stat-value {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .stat-label {
            font-size: 14px;
            opacity: 0.9;
        }
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .data-table th,
        .data-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        .data-table th {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            font-weight: bold;
        }
        .data-table tr:hover {
            background: #f8f9fa;
        }
        .status-badge {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        .status-active {
            background: #d4edda;
            color: #155724;
        }
        .status-banned {
            background: #f8d7da;
            color: #721c24;
        }
        .status-enabled {
            background: #d4edda;
            color: #155724;
        }
        .status-disabled {
            background: #f8d7da;
            color: #721c24;
        }
        .action-buttons {
            display: flex;
            gap: 8px;
        }
        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
            border-radius: 15px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }
        .btn-ban {
            background: linear-gradient(45deg, #ff6b6b, #ee5a5a);
            color: white;
        }
        .btn-unban {
            background: linear-gradient(45deg, #43e97b, #38f9d7);
            color: white;
        }
        .btn-disable {
            background: linear-gradient(45deg, #feca57, #ff9f43);
            color: white;
        }
        .btn-enable {
            background: linear-gradient(45deg, #43e97b, #38f9d7);
            color: white;
        }
        .search-box {
            padding: 10px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            width: 300px;
            font-size: 14px;
        }
        .search-box:focus {
            outline: none;
            border-color: #667eea;
        }
        .server-status {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .server-status-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #e0e0e0;
        }
        .server-status-item:last-child {
            border-bottom: none;
        }
        .server-status-label {
            color: #666;
        }
        .server-status-value {
            font-weight: bold;
            color: #667eea;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ›¡ï¸ ç®¡ç†å‘˜åå°</h1>
        <div class="header-buttons">
            <button class="btn btn-danger" onclick="logout()">é€€å‡ºç™»å½•</button>
            <button class="btn btn-primary" onclick="location.href='../../index.html'">è¿”å›ä¸»é¡µ</button>
        </div>
    </div>

    <div class="main-container">
        <div class="sidebar">
            <ul class="sidebar-menu">
                <li class="active" onclick="showSection('dashboard')">
                    <span>ğŸ“Š</span> æ•°æ®æ¦‚è§ˆ
                </li>
                <li onclick="showSection('users')">
                    <span>ğŸ‘¥</span> ç”¨æˆ·ç®¡ç†
                </li>
                <li onclick="showSection('games')">
                    <span>ğŸ®</span> æ¸¸æˆç®¡ç†
                </li>
                <li onclick="showSection('messages')">
                    <span>ğŸ’¬</span> æ¶ˆæ¯ç®¡ç†
                </li>
                <li onclick="showSection('server')">
                    <span>ğŸ–¥ï¸</span> æœåŠ¡å™¨ç®¡ç†
                </li>
            </ul>
        </div>

        <div class="content">
            <!-- æ•°æ®æ¦‚è§ˆ -->
            <div id="dashboard" class="section active">
                <div class="section-header">
                    <h2>ğŸ“Š æ•°æ®æ¦‚è§ˆ</h2>
                </div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-value" id="totalUsers">0</div>
                        <div class="stat-label">æ€»ç”¨æˆ·æ•°</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="activeUsers">0</div>
                        <div class="stat-label">æ´»è·ƒç”¨æˆ·</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="bannedUsers">0</div>
                        <div class="stat-label">å°ç¦ç”¨æˆ·</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="activeGames">0</div>
                        <div class="stat-label">å¯ç”¨æ¸¸æˆ</div>
                    </div>
                </div>
            </div>

            <!-- ç”¨æˆ·ç®¡ç† -->
            <div id="users" class="section">
                <div class="section-header">
                    <h2>ğŸ‘¥ ç”¨æˆ·ç®¡ç†</h2>
                    <input type="text" class="search-box" placeholder="æœç´¢ç”¨æˆ·..." id="userSearch" onkeyup="filterUsers()">
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ç”¨æˆ·å</th>
                            <th>æ³¨å†Œæ—¶é—´</th>
                            <th>é‡‘å¸</th>
                            <th>çŠ¶æ€</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="userTableBody"></tbody>
                </table>
            </div>

            <!-- æ¸¸æˆç®¡ç† -->
            <div id="games" class="section">
                <div class="section-header">
                    <h2>ğŸ® æ¸¸æˆç®¡ç†</h2>
                </div>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>æ¸¸æˆID</th>
                            <th>æ¸¸æˆåç§°</th>
                            <th>åˆ†ç±»</th>
                            <th>çŠ¶æ€</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="gameTableBody"></tbody>
                </table>
            </div>

            <!-- æ¶ˆæ¯ç®¡ç† -->
            <div id="messages" class="section">
                <div class="section-header">
                    <h2>ğŸ’¬ æ¶ˆæ¯ç®¡ç†</h2>
                </div>
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <h3 style="color: #667eea; margin-bottom: 15px;">å‘é€å…¨å±€å…¬å‘Š</h3>
                    <textarea id="broadcastMessage" style="width: 100%; padding: 15px; border: 2px solid #e0e0e0; border-radius: 10px; resize: vertical; min-height: 100px; font-family: 'Microsoft YaHei', sans-serif;" placeholder="è¾“å…¥å…¬å‘Šå†…å®¹..."></textarea>
                    <button class="btn btn-primary" style="margin-top: 15px;" onclick="sendBroadcast()">å‘é€å…¬å‘Š</button>
                </div>
            </div>

            <!-- æœåŠ¡å™¨ç®¡ç† -->
            <div id="server" class="section">
                <div class="section-header">
                    <h2>ğŸ–¥ï¸ æœåŠ¡å™¨ç®¡ç†</h2>
                </div>
                <div class="server-status">
                    <div class="server-status-item">
                        <span class="server-status-label">æœåŠ¡å™¨çŠ¶æ€</span>
                        <span class="server-status-value">ğŸŸ¢ åœ¨çº¿</span>
                    </div>
                    <div class="server-status-item">
                        <span class="server-status-label">è¿è¡Œæ—¶é—´</span>
                        <span class="server-status-value" id="uptime">--</span>
                    </div>
                    <div class="server-status-item">
                        <span class="server-status-label">CPUä½¿ç”¨ç‡</span>
                        <span class="server-status-value" id="cpuUsage">--</span>
                    </div>
                    <div class="server-status-item">
                        <span class="server-status-label">å†…å­˜ä½¿ç”¨</span>
                        <span class="server-status-value" id="memUsage">--</span>
                    </div>
                </div>
                <div style="display: flex; gap: 15px;">
                    <button class="btn btn-primary" onclick="alert('é‡å¯æœåŠ¡å™¨åŠŸèƒ½å·²è§¦å‘ï¼')">é‡å¯æœåŠ¡å™¨</button>
                    <button class="btn btn-danger" onclick="alert('æ¸…é™¤ç¼“å­˜åŠŸèƒ½å·²è§¦å‘ï¼')">æ¸…é™¤ç¼“å­˜</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ£€æŸ¥ç™»å½•çŠ¶æ€
        if (localStorage.getItem('adminLoggedIn') !== 'true') {
            alert('è¯·å…ˆç™»å½•ï¼');
            location.href = 'admin.html';
        }

        const games = [
            { id: 1, name: 'ç‚¸æ¯æ•Œæœº', category: 'ç«æŠ€å¯¹æˆ˜', enabled: true },
            { id: 2, name: 'æˆ˜æœ¯æ’¤ç¦»', category: 'ç«æŠ€å¯¹æˆ˜', enabled: true },
            { id: 3, name: 'é˜µè¥å¯¹æŠ—', category: 'ç«æŠ€å¯¹æˆ˜', enabled: true },
            { id: 4, name: 'æ•°å­—æ‹†å¼¹ä¸“å®¶', category: 'ç«æŠ€å¯¹æˆ˜', enabled: true },
            { id: 5, name: 'ä¿„ç½—æ–¯æ–¹å—', category: 'è„‘åŠ›ä¼‘é—²', enabled: true },
            { id: 6, name: 'ä½ ç”»æˆ‘çŒœ', category: 'è„‘åŠ›ä¼‘é—²', enabled: true },
            { id: 7, name: 'è°æ˜¯å§åº•', category: 'è„‘åŠ›ä¼‘é—²', enabled: true },
            { id: 8, name: 'ç¼–ç¨‹å¤§å¸ˆ', category: 'è„‘åŠ›ä¼‘é—²', enabled: true },
            { id: 9, name: 'åƒç´ å¤§ä½œæˆ˜', category: 'è„‘åŠ›ä¼‘é—²', enabled: true },
            { id: 10, name: 'å¤å¤æ‰“ç –å—', category: 'è„‘åŠ›ä¼‘é—²', enabled: true },
            { id: 11, name: 'åŒæ¡Œæ¶ˆæ¶ˆä¹', category: 'è¶£å‘³äº’åŠ¨', enabled: true },
            { id: 12, name: 'è„‘æ´æ¼‚æµç“¶', category: 'è¶£å‘³äº’åŠ¨', enabled: true },
            { id: 13, name: 'è¡¨æƒ…è¿è¿çœ‹', category: 'è¶£å‘³äº’åŠ¨', enabled: true },
            { id: 14, name: 'ç­çº§å¤§å¯Œç¿', category: 'è¶£å‘³äº’åŠ¨', enabled: true },
            { id: 15, name: 'å€’æ”¾çŒœæ­Œ', category: 'è¶£å‘³äº’åŠ¨', enabled: true }
        ];

        // æ˜¾ç¤ºæ¿å—
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');

            document.querySelectorAll('.sidebar-menu li').forEach(item => {
                item.classList.remove('active');
            });
            event.currentTarget.classList.add('active');
        }

        // è·å–ç”¨æˆ·æ•°æ®
        function getUsers() {
            const users = localStorage.getItem('gameUsers');
            return users ? JSON.parse(users) : {};
        }

        // æ›´æ–°ç»Ÿè®¡æ•°æ®
        function updateStats() {
            const users = getUsers();
            const userArray = Object.values(users);
            const totalUsers = userArray.length;
            const bannedUsers = userArray.filter(u => u.banned).length;
            const activeUsers = totalUsers - bannedUsers;
            const activeGames = games.filter(g => g.enabled).length;

            document.getElementById('totalUsers').textContent = totalUsers;
            document.getElementById('activeUsers').textContent = activeUsers;
            document.getElementById('bannedUsers').textContent = bannedUsers;
            document.getElementById('activeGames').textContent = activeGames;
        }

        // æ¸²æŸ“ç”¨æˆ·è¡¨æ ¼
        function renderUserTable() {
            const users = getUsers();
            const tbody = document.getElementById('userTableBody');
            tbody.innerHTML = '';

            Object.entries(users).forEach(([username, data]) => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td><strong>${username}</strong></td>
                    <td>${new Date(data.createdAt).toLocaleDateString()}</td>
                    <td>${data.coins || 0}</td>
                    <td>
                        <span class="status-badge ${data.banned ? 'status-banned' : 'status-active'}">
                            ${data.banned ? 'å·²å°ç¦' : 'æ­£å¸¸'}
                        </span>
                    </td>
                    <td>
                        <div class="action-buttons">
                            ${data.banned 
                                ? `<button class="btn-small btn-unban" onclick="unbanUser('${username}')">è§£å°</button>`
                                : `<button class="btn-small btn-ban" onclick="banUser('${username}')">å°ç¦</button>`
                            }
                        </div>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // æ¸²æŸ“æ¸¸æˆè¡¨æ ¼
        function renderGameTable() {
            const tbody = document.getElementById('gameTableBody');
            tbody.innerHTML = '';

            games.forEach(game => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${game.id}</td>
                    <td><strong>${game.name}</strong></td>
                    <td>${game.category}</td>
                    <td>
                        <span class="status-badge ${game.enabled ? 'status-enabled' : 'status-disabled'}">
                            ${game.enabled ? 'å·²å¯ç”¨' : 'å·²ç¦ç”¨'}
                        </span>
                    </td>
                    <td>
                        <div class="action-buttons">
                            ${game.enabled
                                ? `<button class="btn-small btn-disable" onclick="disableGame(${game.id})">ç¦ç”¨</button>`
                                : `<button class="btn-small btn-enable" onclick="enableGame(${game.id})">å¯ç”¨</button>`
                            }
                        </div>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // å°ç¦ç”¨æˆ·
        function banUser(username) {
            if (confirm(`ç¡®å®šè¦å°ç¦ç”¨æˆ· "${username}" å—ï¼Ÿ`)) {
                const users = getUsers();
                if (users[username]) {
                    users[username].banned = true;
                    localStorage.setItem('gameUsers', JSON.stringify(users));
                    renderUserTable();
                    updateStats();
                    alert(`ç”¨æˆ· "${username}" å·²è¢«å°ç¦`);
                }
            }
        }

        // è§£å°ç”¨æˆ·
        function unbanUser(username) {
            if (confirm(`ç¡®å®šè¦è§£å°ç”¨æˆ· "${username}" å—ï¼Ÿ`)) {
                const users = getUsers();
                if (users[username]) {
                    users[username].banned = false;
                    localStorage.setItem('gameUsers', JSON.stringify(users));
                    renderUserTable();
                    updateStats();
                    alert(`ç”¨æˆ· "${username}" å·²è§£å°`);
                }
            }
        }

        // ç¦ç”¨æ¸¸æˆ
        function disableGame(gameId) {
            if (confirm('ç¡®å®šè¦ç¦ç”¨æ­¤æ¸¸æˆå—ï¼Ÿ')) {
                const game = games.find(g => g.id === gameId);
                if (game) {
                    game.enabled = false;
                    localStorage.setItem('gameSettings', JSON.stringify({ games }));
                    renderGameTable();
                    updateStats();
                    alert('æ¸¸æˆå·²ç¦ç”¨');
                }
            }
        }

        // å¯ç”¨æ¸¸æˆ
        function enableGame(gameId) {
            if (confirm('ç¡®å®šè¦å¯ç”¨æ­¤æ¸¸æˆå—ï¼Ÿ')) {
                const game = games.find(g => g.id === gameId);
                if (game) {
                    game.enabled = true;
                    localStorage.setItem('gameSettings', JSON.stringify({ games }));
                    renderGameTable();
                    updateStats();
                    alert('æ¸¸æˆå·²å¯ç”¨');
                }
            }
        }

        // å‘é€å¹¿æ’­
        function sendBroadcast() {
            const message = document.getElementById('broadcastMessage').value.trim();
            if (!message) {
                alert('è¯·è¾“å…¥å…¬å‘Šå†…å®¹');
                return;
            }
            localStorage.setItem('broadcastMessage', message);
            alert('å…¬å‘Šå·²å‘é€ï¼');
            document.getElementById('broadcastMessage').value = '';
        }

        // è¿‡æ»¤ç”¨æˆ·
        function filterUsers() {
            const searchTerm = document.getElementById('userSearch').value.toLowerCase();
            const rows = document.querySelectorAll('#userTableBody tr');
            
            rows.forEach(row => {
                const username = row.cells[0].textContent.toLowerCase();
                row.style.display = username.includes(searchTerm) ? '' : 'none';
            });
        }

        // é€€å‡ºç™»å½•
        function logout() {
            if (confirm('ç¡®å®šè¦é€€å‡ºç™»å½•å—ï¼Ÿ')) {
                localStorage.removeItem('adminLoggedIn');
                localStorage.removeItem('adminLoginTime');
                location.href = 'admin.html';
            }
        }

        // æ›´æ–°æœåŠ¡å™¨ä¿¡æ¯
        function updateServerInfo() {
            const now = new Date();
            const uptime = Math.floor((now.getTime() - parseInt(localStorage.getItem('serverStartTime') || now.getTime())) / 1000 / 60);
            document.getElementById('uptime').textContent = uptime + ' åˆ†é’Ÿ';
            document.getElementById('cpuUsage').textContent = (30 + Math.random() * 40).toFixed(1) + '%';
            document.getElementById('memUsage').textContent = (40 + Math.random() * 30).toFixed(1) + '%';
        }

        // åˆå§‹åŒ–
        updateStats();
        renderUserTable();
        renderGameTable();
        updateServerInfo();
        setInterval(updateServerInfo, 5000);
    </script>
</body>
</html>